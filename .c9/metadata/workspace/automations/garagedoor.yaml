{"changed":true,"filter":false,"title":"garagedoor.yaml","tooltip":"/automations/garagedoor.yaml","value":"# - alias: 'Notify IOS Garage Door Open'\n#   initial_state: True\n#   trigger:\n#     - platform: time\n#       at: '22:00:00' #change this to actual trigger\n#   condition:\n#     condition: state\n#     entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor #id of your garage door relay\n#     state: 'on'\n#   action:\n#     - service: notify.all_phones\n#       data:\n#         title: \"Garage Door Check\"\n#         message: \"It's 10pm and Garage Door is Open\"\n#         data:\n#           push:\n#             badge: 0\n#             category: 'closegarage'\n\n- alias: 'Garage Door Alert'\n  trigger:\n    - platform: state\n      entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor\n      from: 'off'\n      to: 'on'\n      for:\n        minutes: 10\n  action:\n    - service: notify.all_phones\n      data:\n        title: \"Garage Door Open\"\n        message: \"Garage Door has been open for 10 minutes\"\n        data:\n          push:\n            badge: 0\n            category: 'closegarage'\n\n- alias: 'Door Open but No One is Home'\n  trigger:\n    - platform: state\n      entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor\n      to: 'on'\n  condition:\n    condition: state\n    entity_id: group.household\n    state: 'not_home'\n  action:\n    - service: notify.all_phones\n      data:\n        title: \"Garage Door Open\"\n        message: \"But no one is home\"\n        data:\n          push:\n            badge: 0\n            category: 'closegarage'\n\n- alias: 'Garage Door Alert'\n  trigger:\n    - platform: state\n      entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor\n      from: 'off'\n      to: 'on'\n      for:\n        minutes: 10\n  action:\n    - service: notify.all_phones\n      data:\n        title: \"Garage Door Open\"\n        message: \"Garage Door has been open for 10 minutes\"\n        data:\n          push:\n            badge: 0\n            category: 'closegarage'\n\n# Sigh, this literally just turns the switch off\n- alias: Turn off garage door switch\n  hide_entity: 'true'\n  trigger:\n    platform: mqtt\n    topic: 'GarageDoorOpenerSwitchOff'\n  action:\n    - delay: '00:00:01'\n    - service: switch.turn_off\n      entity_id: switch.fortrezz_mimolite_wireless_interfacebridge_module_switch\n#    - service: persistent_notification.create\n#      data:\n#        message: \"Turned switch off\"\n\n- alias: Trigger to turn off garage door switch\n  hide_entity: 'true'\n  trigger:\n    platform: state\n    entity_id: switch.fortrezz_mimolite_wireless_interfacebridge_module_switch\n    from: 'off'\n    to: 'on'\n  action:\n    - service: mqtt.publish\n      data_template:\n        topic: 'GarageDoorOpenerSwitchOff'\n        payload: 'off'\n#    - service: persistent_notification.create\n#      data:\n#        message: Temperature set to {{ states.input_number.downstairs_temperature.state | int }}\n","undoManager":{"mark":73,"position":74,"stack":[[{"start":{"row":17,"column":25},"end":{"row":17,"column":35},"action":"remove","lines":["garagedoor"],"id":2},{"start":{"row":17,"column":25},"end":{"row":17,"column":26},"action":"insert","lines":["c"]}],[{"start":{"row":17,"column":26},"end":{"row":17,"column":27},"action":"insert","lines":["l"],"id":3}],[{"start":{"row":17,"column":27},"end":{"row":17,"column":28},"action":"insert","lines":["o"],"id":4}],[{"start":{"row":17,"column":28},"end":{"row":17,"column":29},"action":"insert","lines":["s"],"id":5}],[{"start":{"row":17,"column":29},"end":{"row":17,"column":30},"action":"insert","lines":["e"],"id":6}],[{"start":{"row":17,"column":30},"end":{"row":17,"column":31},"action":"insert","lines":["_"],"id":7}],[{"start":{"row":17,"column":31},"end":{"row":17,"column":32},"action":"insert","lines":["g"],"id":8}],[{"start":{"row":17,"column":32},"end":{"row":17,"column":33},"action":"insert","lines":["a"],"id":9}],[{"start":{"row":17,"column":33},"end":{"row":17,"column":34},"action":"insert","lines":["r"],"id":10}],[{"start":{"row":17,"column":25},"end":{"row":17,"column":34},"action":"remove","lines":["close_gar"],"id":40},{"start":{"row":17,"column":25},"end":{"row":17,"column":35},"action":"insert","lines":["GARAGEDOOR"]}],[{"start":{"row":17,"column":25},"end":{"row":17,"column":35},"action":"remove","lines":["GARAGEDOOR"],"id":41},{"start":{"row":17,"column":25},"end":{"row":17,"column":26},"action":"insert","lines":["C"]}],[{"start":{"row":17,"column":26},"end":{"row":17,"column":27},"action":"insert","lines":["L"],"id":42}],[{"start":{"row":17,"column":27},"end":{"row":17,"column":28},"action":"insert","lines":["O"],"id":43}],[{"start":{"row":17,"column":28},"end":{"row":17,"column":29},"action":"insert","lines":["S"],"id":44}],[{"start":{"row":17,"column":29},"end":{"row":17,"column":30},"action":"insert","lines":["E"],"id":45}],[{"start":{"row":17,"column":30},"end":{"row":17,"column":31},"action":"insert","lines":["_"],"id":46}],[{"start":{"row":17,"column":31},"end":{"row":17,"column":32},"action":"insert","lines":["G"],"id":47}],[{"start":{"row":17,"column":32},"end":{"row":17,"column":33},"action":"insert","lines":["A"],"id":48}],[{"start":{"row":17,"column":33},"end":{"row":17,"column":34},"action":"insert","lines":["R"],"id":49}],[{"start":{"row":17,"column":34},"end":{"row":17,"column":35},"action":"insert","lines":["A"],"id":50}],[{"start":{"row":17,"column":35},"end":{"row":17,"column":36},"action":"insert","lines":["G"],"id":51}],[{"start":{"row":17,"column":36},"end":{"row":17,"column":37},"action":"insert","lines":["E"],"id":52}],[{"start":{"row":35,"column":23},"end":{"row":35,"column":33},"action":"remove","lines":["GARAGEDOOR"],"id":53},{"start":{"row":35,"column":23},"end":{"row":35,"column":24},"action":"insert","lines":["V"]}],[{"start":{"row":35,"column":23},"end":{"row":35,"column":24},"action":"remove","lines":["V"],"id":54}],[{"start":{"row":35,"column":23},"end":{"row":35,"column":24},"action":"insert","lines":["C"],"id":55}],[{"start":{"row":35,"column":24},"end":{"row":35,"column":25},"action":"insert","lines":["L"],"id":56}],[{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"insert","lines":["O"],"id":57}],[{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"insert","lines":["S"],"id":58}],[{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"insert","lines":["E"],"id":59}],[{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"insert","lines":["_"],"id":60}],[{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"insert","lines":["G"],"id":61}],[{"start":{"row":35,"column":30},"end":{"row":35,"column":31},"action":"insert","lines":["A"],"id":62}],[{"start":{"row":35,"column":31},"end":{"row":35,"column":32},"action":"insert","lines":["R"],"id":63}],[{"start":{"row":35,"column":32},"end":{"row":35,"column":33},"action":"insert","lines":["A"],"id":64}],[{"start":{"row":35,"column":33},"end":{"row":35,"column":34},"action":"insert","lines":["G"],"id":65}],[{"start":{"row":35,"column":34},"end":{"row":35,"column":35},"action":"insert","lines":["E"],"id":66}],[{"start":{"row":17,"column":30},"end":{"row":17,"column":31},"action":"remove","lines":["_"],"id":67}],[{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"remove","lines":["_"],"id":68}],[{"start":{"row":35,"column":34},"end":{"row":35,"column":35},"action":"insert","lines":["\\"],"id":69}],[{"start":{"row":35,"column":34},"end":{"row":35,"column":35},"action":"remove","lines":["\\"],"id":70}],[{"start":{"row":35,"column":33},"end":{"row":35,"column":34},"action":"remove","lines":["E"],"id":71}],[{"start":{"row":35,"column":32},"end":{"row":35,"column":33},"action":"remove","lines":["G"],"id":72}],[{"start":{"row":35,"column":31},"end":{"row":35,"column":32},"action":"remove","lines":["A"],"id":73}],[{"start":{"row":35,"column":30},"end":{"row":35,"column":31},"action":"remove","lines":["R"],"id":74}],[{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"remove","lines":["A"],"id":75}],[{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"remove","lines":["G"],"id":76}],[{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"remove","lines":["E"],"id":77}],[{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"remove","lines":["S"],"id":78}],[{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"remove","lines":["O"],"id":79}],[{"start":{"row":35,"column":24},"end":{"row":35,"column":25},"action":"remove","lines":["L"],"id":80}],[{"start":{"row":35,"column":23},"end":{"row":35,"column":24},"action":"remove","lines":["C"],"id":81}],[{"start":{"row":35,"column":23},"end":{"row":35,"column":24},"action":"insert","lines":["c"],"id":82}],[{"start":{"row":35,"column":24},"end":{"row":35,"column":25},"action":"insert","lines":["l"],"id":83}],[{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"insert","lines":["o"],"id":84}],[{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"insert","lines":["s"],"id":85}],[{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"insert","lines":["e"],"id":86}],[{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"insert","lines":["g"],"id":87}],[{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"insert","lines":["a"],"id":88}],[{"start":{"row":35,"column":30},"end":{"row":35,"column":31},"action":"insert","lines":["r"],"id":89}],[{"start":{"row":35,"column":31},"end":{"row":35,"column":32},"action":"insert","lines":["a"],"id":90}],[{"start":{"row":35,"column":32},"end":{"row":35,"column":33},"action":"insert","lines":["g"],"id":91}],[{"start":{"row":35,"column":33},"end":{"row":35,"column":34},"action":"insert","lines":["e"],"id":92}],[{"start":{"row":17,"column":25},"end":{"row":17,"column":36},"action":"remove","lines":["CLOSEGARAGE"],"id":93},{"start":{"row":17,"column":25},"end":{"row":17,"column":26},"action":"insert","lines":["c"]}],[{"start":{"row":17,"column":26},"end":{"row":17,"column":27},"action":"insert","lines":["l"],"id":94}],[{"start":{"row":17,"column":27},"end":{"row":17,"column":28},"action":"insert","lines":["o"],"id":95}],[{"start":{"row":17,"column":28},"end":{"row":17,"column":29},"action":"insert","lines":["s"],"id":96}],[{"start":{"row":17,"column":29},"end":{"row":17,"column":30},"action":"insert","lines":["e"],"id":97}],[{"start":{"row":17,"column":30},"end":{"row":17,"column":31},"action":"insert","lines":["g"],"id":98}],[{"start":{"row":17,"column":31},"end":{"row":17,"column":32},"action":"insert","lines":["a"],"id":99}],[{"start":{"row":17,"column":32},"end":{"row":17,"column":33},"action":"insert","lines":["r"],"id":100}],[{"start":{"row":17,"column":33},"end":{"row":17,"column":34},"action":"insert","lines":["a"],"id":101}],[{"start":{"row":17,"column":34},"end":{"row":17,"column":35},"action":"insert","lines":["g"],"id":102}],[{"start":{"row":17,"column":35},"end":{"row":17,"column":36},"action":"insert","lines":["e"],"id":103}],[{"start":{"row":54,"column":23},"end":{"row":54,"column":33},"action":"remove","lines":["GARAGEDOOR"],"id":104},{"start":{"row":54,"column":23},"end":{"row":54,"column":34},"action":"insert","lines":["closegarage"]},{"start":{"row":64,"column":24},"end":{"row":64,"column":25},"action":"remove","lines":["_"]}],[{"start":{"row":56,"column":0},"end":{"row":71,"column":0},"action":"remove","lines":["# This is triggered directly from IOS notifcation","- alias: 'iOS app notification action garagedoor'","  initial_state: True","  hide_entity: True","  trigger:","    platform: event","    event_type: ios.notification_action_fired","    event_data:","      actionName: 'CLOSEGARAGE'","  action:","    - service: switch.turn_on","      entity_id: switch.fortrezz_mimolite_wireless_interfacebridge_module_switch","    - delay: '00:00:01'","    - service: switch.turn_off","      entity_id: switch.fortrezz_mimolite_wireless_interfacebridge_module_switch",""],"id":105},{"start":{"row":56,"column":0},"end":{"row":73,"column":0},"action":"insert","lines":["- alias: 'Garage Door Alert'","  trigger:","    - platform: state","      entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor","      from: 'off'","      to: 'on'","      for:","        minutes: 10","  action:","    - service: notify.all_phones","      data:","        title: \"Garage Door Open\"","        message: \"Garage Door has been open for 10 minutes\"","        data:","          push:","            badge: 0","            category: 'closegarage'",""]}]]},"ace":{"folds":[],"scrolltop":600,"scrollleft":0,"selection":{"start":{"row":56,"column":0},"end":{"row":73,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":40,"state":"start","mode":"ace/mode/yaml"}},"timestamp":1515523967896}